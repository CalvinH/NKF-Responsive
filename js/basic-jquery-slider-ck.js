/*
 * jQuery 'Slidey' plug-in v.1.1
 * 
 * http://www.jcwd.com.au
 * @john0514
 *
 * Copyright 2011, John Cobb
 * Free for all to use, abuse and improve under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * August 2011
 */(function(e){e.fn.slidey=function(t){var n={},r={width:990,height:440,animation:"fade",animationDuration:450,automatic:!0,rotationSpeed:4e3,hoverPause:!0,showControls:!0,centerControls:!0,nextText:"Next",prevText:"Prev",showMarkers:!0,centerMarkers:!0,keyboardNav:!0,useCaptions:!0};n=e.extend({},r,t);var i=this;$slider=e("ul.slidey"),slides=$slider.children("a"),slideCount=slides.length,animating=!1,paused=!1,current=0,slidePosition=1,next=0,$active=slides.eq(current),forward="forward",back="backward";slides.css({height:n.height,"max-width":n.width,width:"100%"});$slider.css({height:n.height,"max-width":n.width,width:"100%"});i.css({height:n.height,"max-width":n.width,width:"100%"});if(n.showControls){$controlContainer=e('<ul class="slidey-controls"></ul>');$next=e('<li><a href="#" class="slidey-next" class="controls">'+n.nextText+"</a></li>");$previous=e('<li><a href="#" class="slidey-prev" class="controls">'+n.prevText+"</a></li>");$next.click(function(e){e.preventDefault();animating||u(forward,!1)});$previous.click(function(e){e.preventDefault();animating||u(back,!1)});$next.appendTo($controlContainer);$previous.appendTo($controlContainer);$controlContainer.appendTo(i);if(n.centerControls){$control=$next.children("a");offset=i.height()-$control.height();$next.children("a").css("top",offset).show();$previous.children("a").css("top",offset).show()}}if(n.showMarkers){$markerContainer=e('<ol class="slidey-markers"></ol>');e.each(slides,function(t,r){if(n.animType=="slide")t!=0&&t!=slideCount-1&&($marker=e('<li><a href="#">'+t+"</a></li>"));else{t++;$marker=e('<li><a href="#">'+t+"</a></li>")}$marker.click(function(n){n.preventDefault();!e(this).hasClass("active-marker")&&!animating&&u(!1,t)});$marker.appendTo($markerContainer)});markers=$markerContainer.children("li");markers.eq(current).addClass("active-marker");$markerContainer.appendTo(i);if(n.centerMarkers){offset=(n.width-$markerContainer.width())/2;$markerContainer.css("left",offset)}}n.keyboardNav&&e(document).keyup(function(e){if(!paused){clearInterval(o);paused=!0}if(!animating)if(e.keyCode==39){e.preventDefault();u(forward,!1)}else if(e.keyCode==37){e.preventDefault();u(back,!1)}if(paused&n.automatic){o=setInterval(function(){u(forward)},n.rotationSpeed);paused=!1}});n.useCaptions&&e.each(slides,function(t,n){var r=e(n),i=r.children("img:first-child"),s=i.attr("title"),o=i.attr("alt");if(o){var u=e('<div class="slidey-caption"><h2>'+s+"</h2><p>"+o+"</p></div>");u.appendTo(r)}else{var u=e('<div class="slidey-caption"><h2>'+s+"</h2></div>");u.appendTo(r)}});n.hoverPause&&n.automatic&&i.hover(function(){if(!paused){clearInterval(o);paused=!0}},function(){if(paused){o=setInterval(function(){u(forward)},n.rotationSpeed);paused=!1}});if(n.animation=="slide"){$first=slides.eq(0);$last=slides.eq(slideCount-1);$first.clone().addClass("clone").removeClass("slide").appendTo($slider);$last.clone().addClass("clone").removeClass("slide").prependTo($slider);slides=$slider.children("li");slideCount=slides.length;$wrapper=e('<div class="slidey-wrapper"></div>').css({"max-width":n.width,width:"100%",height:n.height,overflow:"hidden",position:"relative"});$slider.css({"max-width":n.width*slideCount,left:-n.width});slides.css({"float":"left",position:"relative",display:"list-item"});$wrapper.prependTo(i);$slider.appendTo($wrapper)}var s=function(e){n.animation=="fade"&&(e==forward?$active.next().length?next++:next=0:e==back&&($active.prev().length?next--:next=slideCount-1));if(n.animation=="slide"){e==forward&&(next=slidePosition+1);e==back&&(next=slidePosition-1)}return next};if(n.automatic)var o=setInterval(function(){u(forward,!1)},n.rotationSpeed);slides.eq(current).show();$slider.show();var u=function(e,t){if(!animating){e?next=s(e):t&&n.animation=="fade"?next=t-1:next=t;animating=!0;if(n.animation=="fade"){if(n.showMarkers){markers.eq(current).removeClass("active-marker");markers.eq(next).addClass("active-marker")}$next=slides.eq(next);$active.fadeOut(n.animationDuration);$next.fadeIn(n.animationDuration,function(){$active.hide();current=next;$active=$next;animating=!1})}else if(n.animation=="slide"){if(n.showMarkers){markers.eq(slidePosition-1).removeClass("active-marker");next==slideCount-1?markers.eq(0).addClass("active-marker"):next==0?markers.eq(slideCount-3).addClass("active-marker"):markers.eq(next-1).addClass("active-marker")}$slider.animate({left:-next*n.width},n.animationDuration,function(){if(next==0){slidePosition=slideCount-2;$slider.css({left:-slidePosition*n.width})}else if(next==slideCount-1){slidePosition=1;$slider.css({left:-n.width})}else slidePosition=next;animating=!1})}}};return this}})(jQuery);